스토리지 및 데이터베이스
======================


## (1) 인스턴스 스토어 및 Amazon Elastic Block Store (Amazon EBS)

### 1. **인스턴스 스토어**   
> Amazon EC2 인스턴스에 임시 블록 수준 스토리지를 제공
- 인스턴스 스토어는 물리적으로 EC2 인스턴스의 호스트 컴퓨터에 연결 => 인스턴스와 수명이 동일한 디스크 스토리지

- 즉, 인스턴스가 종료되면 인스턴스 스토어의 데이터 손실

- 장기적으로 필요하지 않은 임시 데이터가 포함된 사용 사례에 적합

### 2. **Amazon Elastic Block Store (Amazon EBS)**   
> Amazon EC2 인스턴스에서 사용할 수 있느 **블록 수준 스토리지 볼륨**을 제공   

> EC2 인스턴스를 중지 or 종료해도 연결된 EBS 볼륨의 모든 데이터 사용 가능

- EBS 볼륨을 생성하려면 구성(예: 볼륨 크기 및 유형)을 정의하고 볼륨을 provisioning

- EBS은 **스냅샷**을 생성하여 EBS 볼륨을 증분 백업할 수 있음

#### **Amazon EBS 스냅샷**

<img src="https://github.com/Hakunam97/TIL/blob/master/AWS/images/EBS_%EC%8A%A4%EB%83%85%EC%83%B7.PNG" width="50%" height="40%" title="route53,cloudfront" alt="route53,cloudfront"></img> 

- 증분 백업. 즉, 처음 볼륨을 백업하면 모든 데이터가 복사됨

- 이후의 백업에서는 가장 최근의 스냅샷 이후 변경된 데이터 블록만 저장

- - -

## (2) **Amazon Simple Storage Service (Amazon S3)**   

- **객체 스토리지**에서 각 객체는 데이터, 메타데이터, 키로 구성
- 메타데이터에는 데이터의 내용, 사용 방법, 객체 크기 등에 대한 정보가 포함
- 블록 스토리지에서 파일을 수정하면 변경된 부분만 업데이트 하지만, 객체 스토리지에서 파일을 수정하면 전체 객체가 업데이트됨

### 1. **Amazon S3**   
> 객체 수준 스토리지를 제공하는 서비스   

> 데이터를 버킷에 객체로 저장   
>   > **버킷** : 연관된 객체들을 그룹핑한 최상위 디렉토리   
    > 버킷에 포함된 모든 객체에 대해서 일괄적으로 *인증* 과 *접속 제한* 을 걸 수 있음

- 모든 유형의 파일 업로드 가능

- 저장 공간을 무제한 제공, S3에 저장할 수 있는 객체의 최대 파일 크기는 **5TB**

- 전체 용량은 **무제한**

- 파일을 업로드할 때 권한 설정하여 파일에 대한 표시 여부 및 액세스 제어 가능

- Amazon S3 버전 관리 기능으로 시간 경과에 따른 객체 변경 사항을 추적 가능


### 2. **Amazon S3 스토리지 클래스**
- 데이터를 검색할 빈도

- 필요한 데이터 가용성

1. **S3 Standard**

    - 자주 액세스하는 데이터용
    - 광범위한 사용, 객체에 대한 고가용성 제공
    - 최소 3개의 가용 영역에 데이터를 저장

2. **S3 Standard-Infrequent Access(S3 Standard-IA)**

    - 자주 액세스하지 않는 데이터용
    - 스토리지 가격은 Standard보다 더 저렴하지만 검색 가격은 더 높음
    - 최소 3개의 가용 영역에 데이터를 저장

3. **S3 One Zone-Infrequent Access(S3 One Zone-IA)**

    - 단일 가용 영역에 데이터를 저장
    - S3 Standard-IA보다 낮은 스토리지 가격

    - 스토리지 비용을 절감하려는 경우
    - 가용 영역 장애가 발생할 경우 데이터를 손쉽게 재현할 수 있는 경우

4. **S3 Intelligent-Tiering**

    - 액세스 패턴을 알 수 없거나 자주 변화하는 데이터용
    - 객체당 소량의 월별 모니터링 및 자동화 요금을 부과

    - 사용자가 30일 연속 객체에 액세스하지 않으면 S3는 자동으로 해당 객체를 자주 사용하지 않는 액세스 계층인 **S3 Standard-IA**로 이동
    - 사용자가 **S3 Standard-IA**에 저장된 객체에 액세스하면 Amazon S3는 자동으로 해당 객체를 **S3 Standard**로 이동

5. **S3 Glacier**

    - 데이터 보관용으로 설계된 저비용 스토리지
    - 객체를 몇 분엣 몇 시간 이내에 검색

6. **S3 Glacier Deep Archive**

    - 보관에 이상적인 가장 저렴한 객체 스토리지 클래스
    - 객체를 12시간 이내에 검색
    - 보관된 객체에 대한 검색 시간을 비교하여 **S3 Glacier** vs **Deep Archive**를 결정

### **EBS vs S3**
- 완성 객체를 사용하거나 변경 횟수가 적다면? => **S3**  (객체 스토리지)

- 복잡한 읽기, 쓰기, 변경 기능을 수행한다면? => **EBS**  (블록 스토리지)

- - -

## (3) **Amazon Elastic File System (Amazon EFS)**

### 1. **파일 스토리지**   
> 파일 스토리지에서 여러 클라이언트(예: 사용자, 애플리케이션, 서버 등)가 공유 파일 폴더에 저장된 데이터에 액세스할 수 있음
- 스토리지 서버가 블록 스토리지를 로컬 파일 시스템과 함께 사용하여 파일 구성

- 많은 수의 서비스 및 리소스가 동시에 동일한 데이터에 액세스해야 하는 사용 사례에 적합

### 2. **Amazon Elastic File System (Amazon EFS)**   
> AWS 클라우드 서비스 및 온프레미스 리소스와 함께 사용되는 확장 가능한 파일 시스템

- 파일을 추가 or 제거하면 Amazon EFS가 자동으로 확장하거나 축소됨

- 애플리케이션 중단 없이 온디멘드로 페타바이트 규모로 확장 가능

### **Amazon EBS** vs **Amazon EFS**
- **EBS**
    - EBS 볼륨은 단일 가용 영역에 데이터를 저장
    - Amazon EC2 인스턴스와 EBS 볼륨 모두 동일한 가용 영역에 상주해야 함

- **EFS**
    - 리전별 서비스
    - 여러 가용 영역에 걸쳐 데이터를 저장
    - 중복 스토리지를 사용하면 파일 시스템이 위치한 리전의 모든 가용 영역에서 **동시**에 데이터에 액세스할 수 있음
    - 온프레미스 서버는 **AWS Direct Connect**를 사용하여 **EFS**에 액세스할 수 있음

- - -

## (4) **Amazon Relational Database Service (Amazon RDS)** 
> AWS 클라우드에서 관계형 데이터베이스를 실행할 수 있는 서비스

> SQL based DB 

### 1. **Relational Database (관계형 데이터베이스)**   
> 데이터가 다른 데이터 부분과 관련된 방식으로 저장됨

- 정형 쿼리 언어 **SQL** 사용하여 데이터를 저장하고 쿼리
    - **쿼리** : 데이터 자체의 변경은 하지 않고 속성 데이터를 조사하는 것

### 2. **Amazon RDS**   
> 하드웨어 프로비저닝, 데이터베이스 설정, 패치 적용 백업 등 작업을 자동화하는 관리형 서비스   

- 다른 서비스와 통합하면 AWS Lambda를 사용하여 서버리스 애플리케이션에서 데이터베이스를 쿼리할 수 있음   

- **Amazon RDS 데이터베이스 엔진**이 저장 시 암호화(데이터가 저장되는 동안 보호)
- Or 전송 중 암호화(데이터를 전송 및 수신하는 동안 데이터 보호)를 제공

- Read and write data that changes frequently

### 3. **Amazon RDS 데이터베이스 엔진**   
- Amazon Aurora

- PostgreSQL

- MySQL

- MariaDB

- Oracle Database

- Microsoft SQL Server

### **Amazon Aurora**   
> 엔터프라이즈급 관계형 데이터베이스

- MySQL 및 PostgreSQL 관계형 데이터베이스와 호환, 더 빠름

- 데이터베이스 리소스의 안정성 및 가용성을 유지하면서도 불필요한 입/출력 (I/O) 작업을 줄여 데이터베이스 비용 절감

- 6개의 데이터 복사본을 3개의 가용 영역에 복제

- 지속적으로 **Amazon S3**에 데이터를 백업

- - -

## (5) **Amazon DynamoDB**

### 1. **Non-relational Database** (비관계형 데이터베이스)   
> 테이블을 생성하고 테이블은 데이터를 저장하고 쿼리할 수 있는 장소   
- 행과 열이 아닌 구조를 사용하여 데이터 구성 => **'NoSQL 데이터베이스'**

- **키-값 페어** (구조적 접근 방식 중 하나)   
테이블의 항목에서 언제든지 속성을 추가 or 제거
- 테이블의 모든 항목에 동일한 속성이 있을 필요 없음   

### 2. **Amazon DynamoDB**   
> **키-값** 데이터베이스에 데이터 저장
- 한 자릿수 밀리초 성능 제공 (매우 빠름)
- **서버리스** => 서버를 provisioning, 패치 적용 or 관리할 필요가 없음. SW를 설치, 유지 관리, 운영할 필요도 없음   

- **자동 조정** => DynamoDB는 용량 변화에 맞춰 자동으로 크기를 조정, 일관된 성능 유지.    
즉, 크기를 조정하는 동안에도 고성능이 필요한 사례에 적합

- **데이터 복제 across multiple AZ**

### 3. **Amazon RDS** *vs* **Amazon DynamoDB**   
* **Amazon RDS**

    - 자동 고가용성, 복구 제공
    - 고객이 데이터 소유
    - 고객이 스키마 소유
    - 고객이 네트워크 제어
    - ex) 비즈니스 분석용 제품 (복잡한 관계성)

* **Amazon DynamoDB**

    - 키-값 페어 데이터
    - 대규모 처리량 기능
    - 페타바이트 크기 확장 가능
    - 세분화된 API 액세스
    - ex) RDS 외 모든 사례에 적합

- - -

## (6) **Amazon Redshift**   
> **빅데이터 분석**에 사용할 수 있는 **데이터 웨어하우징** 서비스    
- 데이터 레이크에서 실행되는 수많은 엑사바이트의 비정형 데이터를 대상으로 **단일 SQL 쿼리**를 실행할 수 있음
- Read and write data that changes frequently

- - -

## (7) **Amazon Database Migration Service (AWS DMS)**   
> 원본 데이터베이스와 대상 데이터베이스 간에 데이터를 이동

- Migration이 진행되는 동안 소스 데이터베이스의 모든 기능이 정상 작동

- 해당 데이터베이스에 의존하는 애플리케이션의 가동 중지 시간 최소화

- 원본 데이터베이스와 대상 데이터베이스의 유형이 달라도 됨   

### **! AWS DMS의 다른 사용 사례**
1. **개발 및 테스트 데이터베이스 Migration**   
    > 사용자에게 영향을 주지 않고 개발자가 데이터에서 애플리케이션을 테스트할 수 있음

2. **데이터베이스 통합**   
    > 여러 데이터베이스를 단일 데이터베이스로 결합

3. **연속 복제**   
    > 일회성 Migration이 아닌 데이터의 진행 중 복제본을 다른 대상 원본으로 전송

- - -

## (8) **추가 데이터베이스 서비스**

- **Amazon DocumentDB**   
    > MongoDB Workload를 지원하는 문서 데이터베이스 서비스

    > NoSQL databases

- **Amazon Neptune**
    > 그래프 데이터베이스 서비스

    > 추천 엔진, 사기 탐지, 지식 그래프 등

- **Amazon Quantum Ledger Database(Amazon QLDB)**
    > 원장 데이터베이스 서비스

    > 애플리케이션 데이터에 발생한 모든 변경 사항의 전체 기록을 검토 가능

- **Amazon Managed Blockchain**
    > 오픈 소스 프레임워크를 사용하여 블록체인 네트워크를 생성 및 관리

    > **블록체인** : 중앙 기관 없이 거래를 실행하고 데이터를 공유하는 분산형 원장 시스템

- **Amazon ElastiCache**
    > 자주 사용되는 요청의 읽기 시간 향상을 위해 데이터베이스 위에 **캐싱 계층**을 추가하는 서비스

    > 두 가지 데이터저장소 **Redis** 및 **Memcached**를 지원

- **Amazon DynamoDB Accelerator(DAX)**
    > DynamoDB용 **인 메모리 캐시**

    > 응답시간을 밀리초 -> 마이크로초까지 향상 가능

- - -

