Switching_and_Routing
===

OSI 계층으로 이해
---

##### Application Layer (L7)
> 웹브라우저(http, https), filezilla(ftp)

* Source : Local
* Destination : http://www.naver.com

##### Transport Layer (L4)
> Port주소

- Source : Local (사용하지 않는 임의의 Port 부여)
- Destination : 사용자 설정 or default **port 80** (http)

##### Network Layer (L3)

- Destination : www.naver.com       --->  IP 아님
- DNS Query (hosts --> DNS Cache --> 지정된 DNS Server에 Query)
- www.naver.com --> IP주소 1.1.1.1 로 받음
- Destination IP 1.1.1.1 --> Routing Table을 lookup (Source 지정, 일종의 출구)
- Source IP : 2.2.2.2

##### Data Link Layer (L2)
> Destination IP를 보고 ARP Table lookup

* IP주소 <-> MAC주소 mapping
* 255.255.255.255 <-> ff:ff:ff:ff:ff:ff
* Multicast IP는 01:00:5e:0 + IP (뒤에서 23bit)
* Unicast IP는 NIC에 부여된 MAC주소를 사용
* Unicast IP는 어떤 MAC주소가 어떤 IP와 mapping 되어 있는지 모르기 떄문에 **ARP (Address Resolution Protocol)** 실행
  * Source : 지정된 출구의 MAC주소
  * Destination : ARP Table에 도착지 MAC주소

> Interface에 IP가 입력되면 Routing Table에 IP주소와 Subnet_mask를 계싼하여 해당 Interface가 소속된 네트워크가 Routing Table에 등록됨

> Gateway IP주소가 입력되면 모든 Ip를 뜻하는 0.0.0.0/0이 Routing Table에 등록되고 0.0.0.0/0 IP는 Gateway MAC주소로 가도록 경로 설정

![](images/2023-06-15-13-47-22.png)

> L2, L3의 통신 흐름 도식


ARP
---

#### ARP_Header 구조

![](images/2023-06-15-13-48-57.png)

* Hardware type : L2 네트워크 유형 (ehternet 0x0001)
* Protocol type : L3 네트워크 유형 (IPv4 0x0806, IPv6 0x86D) ---> ethernet header의 ether type과 동일
* Hardware Address Length : L2주소 길이 6byte(48bit)인 6으로 setting
* 