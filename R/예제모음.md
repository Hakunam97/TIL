## 1. 문제 p.77
**Q1 시험 점수 변수 만들고 출력하기**   
다섯 명의 학생이 시험을 봤습니다. 학생들의 시험 점수를 담고 있는 변수를 만들어 출력해보세요. 각 학생의 시험 점수는 아래와 같습니다.   
```
80, 60, 70, 50, 90
```
**Q2 전체 평균 구하기**   
앞 문제에서 만든 변수를 이용해 이 학생들의 전체 평균 점수를 구해 보세요.

**Q3 전체 평균 변수를 만들고 출력하기**   
전체 평균 점수를 담고 있는 새 변수를 만들어 출력해 보세요. 앞 문제를 풀 때 사용한 코드를 응용하여라.

## 답
Q1
```R
score <- c(80, 60, 70, 50, 90)
score
```
Q2
```R
mean(score)
```
Q3
```R
mean_score <- mean(score)
```
- - -

## 2. 문제 p.88   
**Q1 data.frame()과 c()를 조합해 표의 내용을 데이터 프레임으로 만들어 출력해 보세요.**   
```
제품    가격    판매량
사과    1800    24
딸기    1500    38
수박    3000    13
```
**Q2 앞에서 만든 데이터 프레임을 이용해 과일 가격 평균, 판매량 평균을 구해 보세요.**

## 답
Q1
```R
# 데이터 프레임 만들기
sales <- data.frame(fruit = c("사과", "딸기", "수박"), price = c(1800, 1500, 3000), volume = c(24, 38, 13))

# 데이터 프레임 출력하기
sales
```
Q2
```R
mean(sales$price)   # 가격 평균
mean(sales$volume)  # 판매량 평균
```
- - -

## 3. 문제 p.122
mpg 데이터의 cty 변수는 도시연비, hwy 변수는 고속도로 연비를 의미합니다. 변수명을 이해하기 쉬운 단어로 바꾸려고 합니다. mpg 데이터를 이용해 아래 문제를 해결해 보세요.   

**Q1 ggplot2() 패키지의 mpg 데이터를 사용할 수 있도록 불러온 후 복사본을 만드세요**

**Q2 복사본 데이터를 이용해 cty는 city로, hwy는 highway로 수정하세요.**

**Q3 데이터 일부를 출력해 변수명이 바뀌었는지 확인해 보세요. 아래와 같은 결과물이 출력되어야 합니다.**

## 답
Q1
```R
install.packages("ggplot2")
mpg <- as.data.frame(ggplot2::mpg)      # mpg 데이터 불러오기

mpg_new <- mpg                          # 복사본 만들기
```

Q2
```R
# dplyr 패키지의 rename() 이용하여 변수명 바꾸기
install.packages("dplyr")
library(dplyr)

mpg_new <- rename(mpg_new, city = cty)      # cty를 city로 수정
mpg_new <- rename(mpg_new, highway = hwy)   # hwy를 highway로 수정
```

Q3
```R
head(mpg_new)       # 데이터 일부 출력
```
- - -

## 4. 문제 p.123   

`ggplot` 패키지에는 미국 동북중부 437개 지역의 인구통계 정보를 담은 `midwest` 라는 데이터가 들어 있습니다. `midwest` 데이터를 사용해 데이터 분석 문제를 해결해 보세요.

**문제1 `ggplot`의 `midwest` 데이터를 데이터 프레임 형태로 불러온 다음 데이터의 특징을 파악하세요.**

**문제2 `poptotal`(전체 인구) 변수를 `total`로, `popasian`(아시안 인구) 변수를 `asian`으로 수정하세요.**

**문제3 `total`, `asian` 변수를 이용해 '전체 인구 대비 아시아 인구 백분율' 파생변수를 추가하고, 히스토그램을 만들어 분포를 살펴보세요.**

**문제4 아시아 인구 백분율 전체 평균을 구하고, 평균을 초과하면 `"large"`, 그 외에는 `"small"` 을 부여하는 파생변수를 만들어 보세요.**

**문제5 `"large"`와 `"small"`에 해당하는 지역이 얼마나 되는지 빈도표와 빈도 막대 그래프를 만들어 확인해 보세요.**

## 답
Q1
```R
install.packages("ggplot2")
midwest <- as.data.frame(ggplot2::midwest)

head(midwest)
tail(midwest)
View(midwest)
dim(midwest)
str(midwest)
summary(midwest)
. . .
```

Q2
```R
install.packages("dplyr")
library(dplyr)

midwest <- rename(midwest, total = poptotal)
midwest <- rename(midwest, asian = popasian)
```

Q3
```R
midwest$ratio <- midwest$asian/midwest$total*100
hist(midwest$ratio)
```

Q4
```R
mean(midwest$ratio)
## [1] 0.4872462
midwest$group <- ifelse(midwest$ratio > 0.4872462, "large", "small")
```

Q5
```R
table(midwest$group)

library(ggplot2)
qplot(midwest$group)
```
- - -

## 5. 문제 p.133

mpg 데이터를 이용해 분석 문제를 해결

**Q1 자동차 배기량에 따라 고속도로 연비가 다른지 알아보려고 합니다. `displ`(배기량)이 4 이하인 자동차와 5 이상인 자동차 중 어떤 자동차의 `hwy`(고속도로 연비)가 평균적으로 더 높은지 알아보세요.**

**Q2 자동차 제조 회사에 따라 도시 연비가 다른지 알아보려고 합니다. `"audi"`와 `"toyota"` 중 어느 `manufacture`(자동차 제조 회사)의 `cty`(도시 연비)가 평균적으로 더 높은지 알아보세요.**

**Q3 `"chevrolet"`, `"ford"`, `"honda"` 자동차의 고속도로 연비 평균을 알아보려고 합니다. 이 회사들의 데이터를 추출한 후 `hwy` 전체 평균을 구해 보세요.**

## 답
Q1
```R
install.packages("ggplot2")

mpg <- as.data.frame(ggplot2::mpg)      # mpg 데이터 불러오기

mpg_a <- mpg %>% filter(displ <= 4)     # displ 4 이하 추출
mpg_b <- mpg %>% filter(displ >= 5)     # displ 5 이상 추추

mean(mpg_a$hwy)     # displ 4 이하 hwy 평균
mean(mpg_b$hwy)     # displ 5 이상 hwy 평균
```

Q2
```R
mpg_audi <- mpg %>% filter(manufacture == "audi")       # audi 추출
mpg_toyota <- mpg %>% filter(manufacture == "toyota")   # toyota 추출

mean(mpg_audi$cty)      # audi의 cty 평균
mean(mpg_toyota$cty)    # toyota의 cty 평균
```

Q3
```R
# manufacture가 chevrolet, ford, honda에 해당하면 추출
mpg_new <- mpg %>% filter(manufacture %in% c("chevrolet", "ford", "honda"))     # %in%은 포함
mean(mpg_new)
```
- - -

## 6. 문제 p.138

**Q1 mpg데이터는 11개 변수로 구성되어 있습니다. 이 중 일부만 추출해 분석에 활용하려고 합니다. mpg 데이터에서 `class`(자동차 종류), `cty`(도시 연비) 변수를 추출해 새로운 데이터를 만드세요. 새로 만든 데이터의 일부를 출력해 두 변수로만 구성되어 있는지 확인하세요.**

**Q2 자동차 종류에 따라 도시 연비가 다른지 알아보려고 합니다. 앞에서 추출한 데이터를 이용해 `class`(자동차 종류)가 `"suv"`인 자동차와 `"compact"`인 자동차 중 어떤 자동차의 `cty`(도시 연비) 평균이 더 높은지 알아보세요.**

## 답

Q1
```R
install.packages("ggplot2")
mpg <- as.data.frame(ggplot2::mpg)      # mpg 데이터 불러오기

df <- mpg %>% select(class, cty)        # class, cty 변수만 추출
head(df)                                # df 일부만 출력
```

Q2
```R
df_suv <- df %>% filter(class == "suv")         # class가 suv인 행 추출
df_compact <- df %>% filter(class == "compact") # class가 compact인 행 추출

mean(df_suv$cty)        # suv의 cty 평균
mean(df_compact$cty)    # compact의 cty 평균
```
- - -

## 7. 문제 p.141

**Q1 `"audi"`에서 생산한 자동차 중에 어떤 자동차 모델의 `hwy`(고속도로 연비)가 높은지 알아보려고 합니다. `"audi"`에서 생산한 자동차 중 `hwy`가 1~5위에 해당하는 자동차의 데이터를 출력하세요.**

## 답
```R
install.packages("ggplot2")
mpg <- as.data.frame(ggplot2::mpg)      # mpg 데이터 불러오기

mpg %>%
 filter(manufacturer == "audi") %>%     # audi만 추출
 arrange(desc(hwy)) %>%                 # hwy 내림차순 정렬
 head(5)                                # 5행까지 출력
```
- - -

## 8. 문제 p.144

**`mpg`데이터는 연비를 나타내는 변수가 `hwy`(고속도로 연비), `cty`(도시 연비) 두 종류로 분리되어 있습니다. 두 변수를 각각 활용하는 대신 하나의 통합 연비 변수를 만들어 분석하려고 합니다**

**Q1 `mpg()` 데이터 복사본을 만들고, `cty`와 `hwy`를 더한 '합산 연비 변수'를 추가하세요.**

**Q2 앞에서 만든 '합산 연비 변수'를 2로 나눠 '평균 연비 변수'를 추가하세요.**

**Q3 '평균 연비 변수'가 가장 높은 자동차 3종의 데이터를 출력하세요.**

**Q4 1~3번 문제를 해결할 수 있는 하나로 연결된 `dplyr` 구문을 만들어 실행해 보세요. 데이터는 복사본 대신 `mpg` 원본을 이용하세요.**

## 답

Q1
```R
install.packages("ggplot2")
mpg <- as.data.frame(ggplot2::mpg)          # mpg 데이터 불러오기
mpg_new <- mpg                              # 복사본 만들기

mpg_new <- mpg_new %>% mutate(total = cty + hwy)    # 합산 변수 만들기
```

Q2
```R
mpg_new <- mpg_new %>% mutate(mean = total/2)       # 평균 변수 만들기
```

Q3
```R
mpg_new %>%
 arrange(desc(mean)) %>%        # 내림차순 정렬
 head(3)                        # 상위 3행 출력
```

Q4
```R
mpg %>%
 mutate(total = cty + hwy, mean = total/2) %>%      # 합산 변수, 평균 변수 만들기
 arrange(desc(mean)) %>%                            # 내림차순 정렬
 head(3)                                            # 상위 3행 출력
```
- - -

## 9. 문제 p.150

**mpg 데이터를 이용해 분석 문제를 해결해 보세요.**

**Q1 mpg 데이터의 `class`는 `"suv"`, `"compact"` 등 자동차를 특징에 따라 일곱 종류로 분류한 변수입니다. 어떤 차종의 도시 연비가 높은지 비교해 보려고 합니다. `class`별 `cty`평균을 구해 보세요.**

**Q2 앞 문제의 출력 결과는 `class` 값 알파벳 순으로 정렬되어 있습니다. 어떤 차종의 도시 연비가 높은지 쉽게 알아볼 수 있도록 `cty` 평균이 높은 순으로 정렬해 출력하세요.**

**Q3 어떤 회사 자동차의 `hwy`(고속도로 연비)가 가장 높은지 알아보려고 합니다. `hwy` 평균이 가장 높은 회사 세 곳을 출력하세요.**

**Q4 어떤 회사에서 `"compact"`(경차) 차종을 가장 많이 생산하는지 알아보려고 합니다. 각 회사별 `"compact"` 차종 수를 내림차순으로 정렬해 출력하세요.**

## 답

Q1
```R
install.packages("ggplot2")
mpg <- as.data.frame(ggplot2::mpg)      # mpg 데이터 불러오기

mpg %>%
 group_by(class) %>%                    # class별 분리
 summarise(mean_cty = mean(cty))       # cty 평균 구해서 프레임에 표시(통계치 산출)
```

Q2
```R
mpg %>%
 group_by(class) %>%                    # class별 분리
 summarise(mean_cty = mean(cty)) %>%    # cty 평균 구해서 프레임에 표시
 arrange(desc(mean_cty))                # 내림차순 정렬
```

Q3
```R
mpg %>%
 group_by(manufacturer) %>%             # manufacturer별 분리
 summarise(mean_hwy = mean(hwy)) %>%    # hwy 평균 구해서 표시(통계치 산출)
 arrange(desc(mean_hwy)) %>%            # 내림차순 정렬
 head(3)                                # 상위 3행 출력
```

Q4
```R
mpg %>%
 filter(class == "compact") %>%     # compact 추출
 group_by(manufacturer) %>%         # manufacturer별 분리
 summarise(count = n()) %>%         # 빈도 구하기
 arrange(desc(count))               # 내림차순 정렬
```
- - -

## 10. 문제 p.157

**Q1 mpg 데이터에는 연료 종류를 나타낸 `f1` 변수는 있지만 연료 가격을 나타낸 변수는 없습니다. 위에서 만든 `fuel` 데이터를 이용해 mpg 데이터에 `price_f1`(연료 가격) 변수를 추가하세요.**

**Q2 연료 가격 변수가 잘 추가됐는지 확인하기 위해 `model`, `f1`, `price_f1` 변수를 추출해 앞부분 5행을 출력해 보세요.**

## 답

Q1
```R
install.packages("ggplot2")
install.packages("dplyr")
library(dplyr)
mpg <- as.data.frame(ggplot2::mpg)      # mpg 데이터 불러오기

mpg <- left_join(mpg, fuel, by = "f1")  # mpg에 연료 가격 변수 추가
```

Q2
```R
mpg %>%
 select(model, f1, price_f1) %>%        # model, f1, price_f1 추출
 head(5)                                # 앞부분 일부 출력
```
- - -

## 11. 문제 p.160

`midwest`는 `ggplot2` 패키지에 들어 있습니다.

**문제1 `popadults`는 해당 지역의 성인 인구, `poptotal`은 전체 인구를 나타냅니다. `midwest` 데이터에 '전체 인구 대비 미성년 인구 백분율' 변수를 추가하세요.**

**문제2 미성년 인구 백분율이 가장 높은 상위 5개 `county`(지역)의 미성년 인구 백분율을 출력하세요**

**문제3 분류표의 기준에 따라 미성년 비율 등급 변수를 추가하고, 각 등급에 몇 개의 지역이 있는지 알아보세요.**
```
분류    기준
large   40%이상
middle  30~40% 미만
small   30% 미만
```

**문제4 `popasian`은 해당 지역의 아시아인 인구를 나타냅니다. '전체 인구 대비 아시아인 인구 백분율' 변수를 추가하고  하위 10개 지역의 `state`(주), `county`(지역), 아시아인 인구 백분율을 출력하세요.**

## 답

Q1
```R
install.packages("ggplot2")
midwest <- as.data.frame(ggplot2::midwest)      # midwest 불러오기

# midwest에 백분율 변수 추가
midwest <- midwest %>%
 mutate(ratio_child = (poptotal = popadults)/poptotal*100)
```

Q2
```R
midwest %>%
 arrange(desc(ratio_child)) %>%         # ratio_child 내림차순 정렬
 select(county, ratio_child) %>%        # county, ratio_child만 추출
 head(5)                                # 상위 5행 출력
```

Q3
```R
# midwest에 grade 변수 추가
midwest <- midwest %>%
 mutate(grade = ifelse(ratio_child >= 40, "large",
                         ifelse(ratio_child >= 30, "middle", "small")))

# 미성년 비율 등급 빈도표
table(midwest$grade)
```

Q4
```R
midwest %>%
 mutate(ratio_asian = (popasian/poptotal)*100) %>%      # 백분율 변수 추가
 arrange(ratio_asian) %>%                               # 올림차순 정렬
 select(state, county, ratio_asian) %>%                 # 3개 변수만 추출
 head(10)                                               # 상위 10행 출력
```
- - -

## 12. 문제 p.170

```R
mpg <- as.data.frame(ggplot2::mpg)
mpg[c(65, 124, 131, 153, 212), "hwy"] <- NA     # NA(결측치) 할당하기
```

**Q1 `drv`(구동 방식)별로 `hwy`(고속도로 연비) 평균이 어떻게 다른지 알아보려고 합니다. 분석을 하기 전에 우선 두 변수에 결측치가 있는지 확인해야 합니다. `drv` 변수와 `hwy` 변수에 결측치가 몇 개 있는지 알아보세요.**

**Q2 `filter()`를 이용해 `hwy` 변수의 결측치를 제외하고, 어떤 `drv`(구동 방식)의 `hwy` 평균이 높은지 알아보세요. 하나의 `dplyr` 구문으로 만들어야 합니다.**

## 답

Q1
```R
table(is.na(mpg$drv))       # drv 결측치 빈도표 출력

## FALSE
##   234

table(is.na(mpg$hwy))       # hwy 결측치 빈도표 출력

## FALSE    TRUE
##   229       5
```

Q2
```R
mpg %>%
 filter(!is.na(hwy)) %>%            # 결측치 제외
 group_by(drv) %>%                  # drv별 분리
 summarise(mean_hwy = mean(hwy))    # hwy 평균 구하기
```
- - -

## 13. 문제 p.178

우선 mpg 데이터를 부러와 일부러 이상치를 만들겠습니다. `drv`(구동 방식) 변수의 값은 `4`(사륜구동), `f`(전륜구동), `r`(후륜구동) 세 종류로 되어 있습니다. 몇 개의 행에 존재할 수 없는 값 `k`를 할당하겠습니다. `cty`(도시 연비) 변수도 몇 개의 행에 극단적으로 크거나 작은 값을 할당하겠습니다

```R
mpg <- as.data.frame(ggplot2::mpg)
mpg[c(10, 14, 58, 93), "drv"] <- "k"                # drv 이상치 할당
mpg[c(29, 43, 129, 203), "cty"] <- c(3, 4, 39, 42)  # cty 이상치 할당
```

**Q1 drv에 이상치가 있는지 확인하세요. 이상치를 결측 처리한 후 이상치가 사라졌는지 확인하세요. 결측 처리를 할 때는 `%in%` 기호를 활용하세요.**

**Q2 상자 그림을 이용해 `cty`에 이상치가 있는지 확인하세요. 상자 그림의 통계치를 이용해 정상 범위를 벗어난 값을 결측 처리한 후 다시 상자 그림을 만들어 이상치가 사라졌는지 확인하세요.**

**Q3 두 변수의 이상치를 결측 처리 했으니 이제 분석할 차례입니다. 이상치를 제외한 다음 `drv`별로 `cty`평균이 어떻게 다른지 알아보세요. 하나의 `dplyr`구문으로 만들어야 합니다.**

## 답

Q1
```R
table(mpg$drv)       # 이상치 확인

# drv가 4, f, r이면 기존 값 유지, 그 외 NA 할당
mpg$drv <- ifelse(mpg$drv %in% c("4", "f", "r"), mpg$drv, NA)

table(mpg$drv)      # 다시 이상치 확인
```

Q2
```R
install.packages("dplyr")
library(dplyr)

boxplot(mpg$cty)$stats      # 상자 그림 생성 및 통계치 산출

mpg$cty <- ifelse(mpg$cty < 9 | mpg$cty > 26, NA, mpg$cty)      # 9~26 벗어나면 NA 할당

boxplot(mpg$cty)        # 상자 그림 다시 생성
```

Q3
```R
mpg %>%
 filter(!ins.na(drv) & !is.na(cty)) %>%         # 결측치 제외
 group_by(drv) %>%                              # drv별 분리
 summarise(mean_cty = mean(cty))                # cty 평균 구하기
```
- - -

## 14. 문제 p.188

**Q1 mpg 데이터의 `cty`(도시 연비)와 `hwy`(고속도로 연비) 간에 어떤 관계가 있는지 알아보려고 합니다. x축은 `cty`, y축은 `hwy`로 된 산점도를 만들어 보세요.**

**Q2 midwest 데이터를 이용해 x축은 `poptotal`(전체 인구), y축은 `popasian`(아시아인 인구)으로 된 산점도를 만들어 보세요. 전체 인구는 50만 명 이하, 아시아인 인구는 1만 명 이하인 지역만 산점도에 표시되게 설정하세요.**

## 답

Q1
```R
install.packages("ggplot2")
library(ggplot2)

ggplot(data = mpg, aes(x = cty, y = hwy)) + geom_point()
```

Q2
```R
ggplot(data = midwest, aes(x = poptotal, y = popasian)) +
 geom_point() +
 xlim(0, 500000) +
 ylim(0, 10000)
```

- - -

## 15. 문제 p.193

**Q1 어떤 회사에서 생산한 `suv` 차종의 도시 연비가 높은지 알아보려고 합니다. `"suv"`차종을 대상으로 평균 `cty`(도시 연비)가 가장 높은 회사 다섯 곳을 막대 그래프로 표현해 보세요. 막대는 연비가 높은 순으로 정렬하세요**

**Q2 자동차 중에서 어떤 `class`(자동차 종류)가 가장 많은지 알아보려고 합니다. 자동차 종류별 빈도를 표현한 막대 그래프를 만들어 보세요.**

## 답

Q1
```R
mpg <- as.data.frame(ggplot2::mpg)

df <- mpg %>%
 filter(class == "suv") %>%
 group_by(manufacturer) %>%
 summarise(mean_cty = mean(cty)) %>%
 arrange(desc(mean_cty)) %>%
 head(5)

ggplot(data = df, aes(x = reorder(manufacturer, -mean_cty), y = mean_cty)) + geom_col()
```

Q2
```R
ggplot(data = mpg, aes(x = class)) + geom_bar()
```
- - -

## 16. 문제 p.195

**`economics` 데이터를 이용해 `psavert`(개인 저축률)가 시간에 따라 어떻게 변해 왔는지 알아보려고 합니다. 시간에 따른 개인 저축률의 변화를 나타낸 시계열 그래프를 만들어 보세요.**

## 답
```R
ggplot(data = economics, aes(x = date, y = psavert)) + geom_line()
```
- - -

## 17. 문제 p.198

**mpg 데이터를 이용해 `class`(자동차 종류)가 `"compact"`, `"subcompact"`, `"suv"`인 자동차의 `cty`(도시 연비)가 어떻게 다른지 비교해 보려고 합니다. 세 차종의 `cty`를 나타낸 상자 그림을 만들어 보세요.**

## 답
```R
mpg <- as.data.frame(ggplot2::mpg)

class_mpg <- mpg %>% filter(class %in% c("compact", "subcompact", "suv"))

ggplot(data = class_mpg, aes(x = class, y = cty)) + geom_boxplot()
```

